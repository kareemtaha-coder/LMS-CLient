<div class="h-full flex flex-col" (touchstart)="onTouchStart($event)" (touchend)="onTouchEnd($event)">
  <!-- Slide Header -->
  <header class="flex items-center justify-between px-6 py-3 text-sm text-gray-600 dark:text-gray-300">
    <div class="flex items-center gap-3 w-4/5">
      <div class="flex items-center gap-2">
        <span class="inline-flex items-center justify-center w-7 h-7 rounded-md bg-indigo-600 text-white font-semibold">{{ currentIndex() + 1 }}</span>
        <span>/</span>
        <span>{{ totalSlides() }}</span>
      </div>
      @if (currentTitle()) {
        <div class="text-base font-semibold text-gray-700 dark:text-gray-100 truncate" style="font-family: 'Amiri Quran', 'Scheherazade New', 'Traditional Arabic', serif;">
          {{ currentTitle() }}
        </div>
      }
    </div>
    <div class="opacity-75 text-xs md:text-sm">استخدم الأسهم ← → أو اسحب للتنقل</div>
  </header>

  <!-- Slide Area -->
  <main class="h-full overflow-hidden">
    @if (lessonService.selectedContent(); as content) {
      <div class="h-full w-full flex items-center justify-center animate-lesson-fade-in">
        <app-content-host [content]="content" />
      </div>
    } @else {
      <div class="flex items-center justify-center h-full">
        <p class="text-slate-500">
          {{ lessonService.loading() ? 'Loading lesson...' : 'No content available.' }}
        </p>
      </div>
    }
  </main>

  <!-- Floating Nav Buttons -->
  <div class="fixed top-1/2 -translate-y-1/2 right-4 z-20 flex flex-col gap-3">
    <button (click)="navigateToPreviousContent()" [disabled]="!hasPreviousContent()" [ngClass]="{'opacity-30 cursor-not-allowed': !hasPreviousContent()}" class="w-12 h-12 flex items-center justify-center bg-white/80 dark:bg-gray-900/80 backdrop-blur-sm rounded-full shadow-lg hover:scale-110 active:scale-100 transition-all">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 15l7-7 7 7" /></svg>
    </button>
    <button (click)="navigateToNextContent()" [disabled]="!hasNextContent()" [ngClass]="{'opacity-30 cursor-not-allowed': !hasNextContent()}" class="w-12 h-12 flex items-center justify-center bg-white/80 dark:bg-gray-900/80 backdrop-blur-sm rounded-full shadow-lg hover:scale-110 active:scale-100 transition-all">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" /></svg>
    </button>
  </div>

  <!-- Progress Dots -->
  <footer class="flex items-center justify-center gap-2 py-4">
    @for (idx of slideIndices(); track idx) {
      <button (click)="navigateToIndex(idx)" class="w-2.5 h-2.5 rounded-full transition-all" [ngClass]="idx === currentIndex() ? 'bg-indigo-600 w-6' : 'bg-gray-300 dark:bg-gray-600 hover:bg-gray-400'" [attr.aria-label]="'Go to slide ' + (idx + 1)"></button>
    }
  </footer>
</div>
